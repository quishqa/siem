
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://quishqa.github.io/siem/tutorials/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../how-to-guides/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Tutorials - SIEM: SImplified Emission Model</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=MerriWeather+Sans:300,300i,400,400i,700,700i%7CRed+Hat+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"MerriWeather Sans";--md-code-font:"Red Hat Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorials" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SIEM: SImplified Emission Model" class="md-header__button md-logo" aria-label="SIEM: SImplified Emission Model" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SIEM: SImplified Emission Model
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorials
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/quishqa/siem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    quishqa/siem
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SIEM: SImplified Emission Model" class="md-nav__button md-logo" aria-label="SIEM: SImplified Emission Model" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SIEM: SImplified Emission Model
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/quishqa/siem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    quishqa/siem
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SIEM Docs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defining-emissions-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Defining emissions attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defining emissions attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spatial-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Spatial proxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporal-profile" class="md-nav__link">
    <span class="md-ellipsis">
      Temporal profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pollutant-emission-factors" class="md-nav__link">
    <span class="md-ellipsis">
      Pollutant emission factors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#voc-and-pm-speciation" class="md-nav__link">
    <span class="md-ellipsis">
      VOC and PM speciation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-emissionsource-object" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an EmissionSource object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-pointsource-object" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an PointSource object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating an PointSource object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-point-source-csv-file" class="md-nav__link">
    <span class="md-ellipsis">
      Reading point source .csv file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-emission-molecular-weight" class="md-nav__link">
    <span class="md-ellipsis">
      Defining emission molecular weight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-pointsource" class="md-nav__link">
    <span class="md-ellipsis">
      Defining PointSource
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-groupsources-object" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a GroupSources object
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How-to Guides
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explanation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SIEM Reference
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defining-emissions-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Defining emissions attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defining emissions attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spatial-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Spatial proxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporal-profile" class="md-nav__link">
    <span class="md-ellipsis">
      Temporal profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pollutant-emission-factors" class="md-nav__link">
    <span class="md-ellipsis">
      Pollutant emission factors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#voc-and-pm-speciation" class="md-nav__link">
    <span class="md-ellipsis">
      VOC and PM speciation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-emissionsource-object" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an EmissionSource object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-pointsource-object" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an PointSource object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating an PointSource object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-point-source-csv-file" class="md-nav__link">
    <span class="md-ellipsis">
      Reading point source .csv file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-emission-molecular-weight" class="md-nav__link">
    <span class="md-ellipsis">
      Defining emission molecular weight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-pointsource" class="md-nav__link">
    <span class="md-ellipsis">
      Defining PointSource
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-groupsources-object" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a GroupSources object
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="tutorials">Tutorials</h1>
<p><code>siem</code> works with three classes to define our emissions:</p>
<ul>
<li><code>EmissionSource</code>: Mainly built to calculate and distribute vehicular emissions using a spatial proxy.</li>
<li><code>PointSource</code>: Mainly built to distribute point emissions that are loaded in a table (i.e. <code>.csv</code> file).</li>
<li><code>GroupSources</code>: Built to merge all the <code>EmissionSource</code> and <code>PointSource</code> object in one single object.
Useful to create the final emission that goes to the air quality model.</li>
</ul>
<p>Each of theses objects has the <code>.to_wrfchem</code> and <code>.to_cmaq</code> methods that allows to create the emission file for WRF-Chem and CMAQ respectively.</p>
<h2 id="defining-emissions-attributes">Defining emissions attributes</h2>
<p>Because emissions varies in space, in time, in species, these factors need to be defined in <code>EmissionSource</code> and <code>PointSource</code> attributes.
Let's start by explaining how to define them.</p>
<h3 id="spatial-proxy">Spatial proxy</h3>
<p>The spatial proxy is a file that have the weights (ratios) to spatially distribute an <strong>n</strong> number of sources (i.e. vehicles) in the simulation domain.
For that reason it is required to have the same number of <code>west_east</code> and <code>south_north</code> points in the <code>wrfinput</code> file.</p>
<p>A spatial proxy file has the following format:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="m">159</span><span class="w"> </span>-46.60239219665527<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="m">160</span><span class="w"> </span>-46.59200668334961<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="m">161</span><span class="w"> </span>-46.581621170043945<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="m">162</span><span class="w"> </span>-46.57123374938965<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="m">163</span><span class="w"> </span>-46.560848236083984<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="m">164</span><span class="w"> </span>-46.55046272277832<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="m">165</span><span class="w"> </span>-46.54007530212402<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">1</span>.7393638309449484
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="m">166</span><span class="w"> </span>-46.52968978881836<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">4</span>.358224109569712
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="m">167</span><span class="w"> </span>-46.519304275512695<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">2</span>.098392445514633
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="m">168</span><span class="w"> </span>-46.5089168548584<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="m">169</span><span class="w"> </span>-46.498531341552734<span class="w"> </span>-24.044368743896484<span class="w"> </span><span class="m">0</span>.0
</span></code></pre></div>
<p>The first column is the <strong>id</strong>, the second column is the <strong>longitude</strong>, the third column is the <strong>latitude</strong>,
and the fourth column is the weight of the emissions sources.</p>
<p>So, to prepare these file to be used in <code>EmissionSource</code>, we use the <code>read_spatial_proxy()</code> function from the <code>spatial</code> module.
Let's imagine that the proxy represents the gasoline vehicles.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">siem.spatial</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_spatial_proxy</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">gasoline_spatial_proxy</span> <span class="o">=</span> <span class="n">read_spatial_proxy</span><span class="p">(</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  <span class="n">proxy_path</span><span class="o">=</span><span class="s1">&#39;./highways_data/highways_d01.csv&#39;</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  <span class="n">col_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss_weight&#39;</span><span class="p">],</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  <span class="n">proxy</span><span class="o">=</span><span class="s1">&#39;emiss_weight&#39;</span><span class="p">,</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>  <span class="n">lon_name</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>  <span class="n">lan_name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="temporal-profile">Temporal profile</h3>
<p>The temporal is just a list with at least 24 elements (hourly weight), one for each hour of the day.
It has to be in <strong>UTC</strong>.</p>
<p>For example a temporal profile for gasoline vehicles can be defined as:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">gasoline_temp_prof</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="mf">0.020</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="mf">0.010</span><span class="p">,</span> <span class="mf">0.020</span><span class="p">,</span> <span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.080</span><span class="p">,</span> <span class="mf">0.080</span><span class="p">,</span> <span class="mf">0.064</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="mf">0.060</span><span class="p">,</span> <span class="mf">0.052</span><span class="p">,</span> <span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.057</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="mf">0.070</span><span class="p">,</span> <span class="mf">0.090</span><span class="p">,</span> <span class="mf">0.090</span><span class="p">,</span> <span class="mf">0.060</span><span class="p">,</span> <span class="mf">0.040</span><span class="p">,</span> <span class="mf">0.034</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="p">]</span>
</span></code></pre></div>
<p>The temporal profile can also be a column of a data frame.</p>
<h3 id="pollutant-emission-factors">Pollutant emission factors</h3>
<p>The pollutant emission factors are defined using a <code>dict()</code>.
The dictionary keys are the names of pollutants in the emission inventory.
The dictionary values are a <code>tuple</code> where the first element is the emission factors (g day^-1),
and the second element is the molecular weight (g mol^-1).</p>
<p>Following the gasoline vehicles, we can define its emission factors as:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">gasoline_ef</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  <span class="s2">&quot;CO&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.173</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  <span class="s2">&quot;NO&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.010</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  <span class="s2">&quot;RCHO&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0005</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>  <span class="s2">&quot;VOC&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.012</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  <span class="s2">&quot;PM&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this example, we define the emission factor of CO (carbon monoxide),
NO (nitrogen monoxide), RCHO (aldehydes), VOC (Volatile Organic Compound),
and PM (Particulate Matter).</p>
<div class="admonition warning">
<p class="admonition-title">About VOC and PM emission factors</p>
<p>It is required to have "VOC" and "PM" keys on the dictionary,
as they will be latter speciated. If there is no information, you can zero them by
using <code>VOC: (0, 100)</code> or <code>PM: (0, 1)</code>. Also, <strong>PM molecular weight is always 1</strong>.</p>
</div>
<h3 id="voc-and-pm-speciation">VOC and PM speciation</h3>
<p>Many chemical mechanisms and aerosol modules use different species for both VOC and PM.
<code>siem</code> speciation is based on <strong>percentage of total emissions</strong>.
The speciation is also saved in a <code>dict()</code>,
where the keys are the VOC or PM species of the selected chemical mechanism or module aerosol,
and the values are the percentage of the total VOC or PM emissions.</p>
<p>For example, for CBMZ and MOSAIC we can have:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">gasoline_voc_cbmz</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="s2">&quot;ETH&quot;</span><span class="p">:</span> <span class="mf">0.282625</span><span class="p">,</span> <span class="s2">&quot;HC3&quot;</span><span class="p">:</span> <span class="mf">0.435206</span><span class="p">,</span> <span class="s2">&quot;HC5&quot;</span><span class="p">:</span> <span class="mf">0.158620</span><span class="p">,</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="s2">&quot;HC8&quot;</span><span class="p">:</span> <span class="mf">0.076538</span><span class="p">,</span> <span class="s2">&quot;OL2&quot;</span><span class="p">:</span> <span class="mf">0.341600</span><span class="p">,</span> <span class="s2">&quot;OLT&quot;</span><span class="p">:</span> <span class="mf">0.143212</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="s2">&quot;OLI&quot;</span><span class="p">:</span> <span class="mf">0.161406</span><span class="p">,</span> <span class="s2">&quot;ISO&quot;</span><span class="p">:</span> <span class="mf">0.004554</span><span class="p">,</span> <span class="s2">&quot;TOL&quot;</span><span class="p">:</span> <span class="mf">0.140506</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="s2">&quot;XYL&quot;</span><span class="p">:</span> <span class="mf">0.157456</span><span class="p">,</span> <span class="s2">&quot;KET&quot;</span><span class="p">:</span> <span class="mf">0.000083</span><span class="p">,</span> <span class="s2">&quot;CH3OH&quot;</span><span class="p">:</span> <span class="mf">0.001841</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="p">}</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">gasoline_pm_mosaic</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="s2">&quot;PM25I&quot;</span><span class="p">:</span> <span class="mf">0.032</span><span class="p">,</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="s2">&quot;PM25J&quot;</span><span class="p">:</span> <span class="mf">0.096</span><span class="p">,</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="s2">&quot;SO4I&quot;</span><span class="p">:</span> <span class="mf">0.0024</span><span class="p">,</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="s2">&quot;SO4J&quot;</span><span class="p">:</span> <span class="mf">0.0156</span><span class="p">,</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="o">....</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="p">}</span>
</span></code></pre></div>
<p>Therefore, <code>siem</code> can be used for different chemical mechanism as the speciation is defined by the user and the available information.</p>
<h2 id="creating-an-emissionsource-object">Creating an <code>EmissionSource</code> object</h2>
<p>Once we have and prepare the emission information, we can now create the object.
In the following example,
We will create an <code>EmissionSource</code> object that save information of all the <strong>gasoline vehicles</strong> of a city.
Let's imagine that there are <strong>1 000 000 of these vehicles</strong>, and on average they run <strong>13 495 km per year</strong>.
So:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">siem.siem</span><span class="w"> </span><span class="kn">import</span> <span class="n">EmissionSource</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">gasoline</span> <span class="o">=</span> <span class="n">EmissionSource</span><span class="p">(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Gasoline vehicles&quot;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">number</span><span class="o">=</span><span class="mi">1_000_000</span><span class="p">,</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="n">use_intensity</span><span class="o">=</span> <span class="mi">13_495</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span>  <span class="c1"># km day ^ -1</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="n">pol_ef</span><span class="o">=</span><span class="n">gasoline_ef</span><span class="p">,</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">spatial_proxy</span><span class="o">=</span><span class="n">gasoline_spatial_proxy</span><span class="p">,</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="n">temporal_profile</span><span class="o">=</span><span class="n">temp_prof</span><span class="p">,</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="n">voc_spc</span><span class="o">=</span><span class="n">gasoline_voc_cbmz</span><span class="p">,</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="n">pm_spc</span><span class="o">=</span><span class="n">gasoline_pm_mosaic</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="p">)</span>
</span></code></pre></div>
<p>We can create another object with the information of diesel vehicles.
Let us assume that there are <strong>40 000</strong> diesel vehicles that run the same as the gasoline vehicles.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">diesel</span> <span class="o">=</span> <span class="n">EmissionSource</span><span class="p">(</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Diesel vehicles&quot;</span><span class="p">,</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">number</span><span class="o">=</span><span class="mi">40_000</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">use_intensity</span><span class="o">=</span> <span class="mi">13_495</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span>  <span class="c1"># km day ^ -1</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">pol_ef</span><span class="o">=</span><span class="n">diesel_ef</span><span class="p">,</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="n">spatial_proxy</span><span class="o">=</span><span class="n">diesel_spatial_proxy</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="n">temporal_profile</span><span class="o">=</span><span class="n">diesel_temp_prof</span><span class="p">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="n">voc_spc</span><span class="o">=</span><span class="n">diesel_voc_cbmz</span><span class="p">,</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="n">pm_spc</span><span class="o">=</span><span class="n">diesel_pm_mosaic</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="p">)</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">About the diesel example</p>
<p>Notice that <code>diesel</code> is define using different attributes
(i.e. different spatial proxy, temporal profile, speciation, etc).
If you have the information each EmissionSource can have different 
attributes, otherwise, you can repeat the attributes for other EmissionSource.</p>
</div>
<h2 id="creating-an-pointsource-object">Creating an <code>PointSource</code> object</h2>
<p>Now, if you have an emission file in <code>.csv</code> with point information total emission (kT year^-1),
you can use <code>PointSource</code> to load the emissions,
but first you need to read the <code>.csv</code></p>
<h3 id="reading-point-source-csv-file">Reading point source <code>.csv</code> file</h3>
<p>We use the function <code>read_point_sources()</code> from <code>point</code> module to prepare our <code>.csv</code> file.
This function will sum each of the point sources located inside domain cells.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">siem.point</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_point_sources</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">geogrid</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./geo_em.d01.nc&#39;</span><span class="p">)</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="n">_</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">XLAT_M</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">point_dom</span> <span class="o">=</span> <span class="n">read_point_sources</span><span class="p">(</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>  <span class="n">point_path</span><span class="o">=</span><span class="s1">&#39;./city_industries.tsv&#39;</span><span class="p">,</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  <span class="n">geo_path</span><span class="o">=</span><span class="s1">&#39;./geo_em.d01.nc&#39;</span><span class="p">,</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>  <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span> 
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>  <span class="n">nrow</span><span class="o">=</span><span class="n">nrow</span><span class="p">,</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>  <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> 
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>  <span class="n">lat_name</span><span class="o">=</span><span class="s1">&#39;LAT&#39;</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>  <span class="n">lon_name</span><span class="o">=</span><span class="s1">&#39;LON&#39;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="defining-emission-molecular-weight">Defining emission molecular weight</h3>
<p>Because the <code>.csv</code> file already have the total emissions calculate,
we do not need the emission factors,
<code>PointSource</code> only needs the molecular weight of the emissions.
We define it using a <code>dict()</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">pol_mw</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>  <span class="s1">&#39;CO&#39;</span><span class="p">:</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">14</span><span class="p">,</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  <span class="s1">&#39;SO2&#39;</span><span class="p">:</span> <span class="mi">32</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>  <span class="s1">&#39;NO2&#39;</span><span class="p">:</span> <span class="mi">14</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>  <span class="s1">&#39;VOC&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>  <span class="s1">&#39;PM&#39;</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">About VOC and PM molecular weight</p>
<p>As in the case of <code>EmissionSource</code>, it is required to have "VOC" and "PM" keys on the dictionary,
as they will be latter speciated.</p>
</div>
<h3 id="defining-pointsource">Defining <code>PointSource</code></h3>
<p>Now we can create our <code>PointSource</code> as following:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">city_point_source</span> <span class="o">=</span> <span class="n">PointSources</span><span class="p">(</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;City industries&#39;</span><span class="p">,</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>  <span class="n">point_emiss</span><span class="o">=</span><span class="n">point_dom</span><span class="p">,</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  <span class="n">pol_emiss</span><span class="o">=</span><span class="n">pol_mw</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>  <span class="n">temporal_profile</span><span class="o">=</span><span class="n">ind_temp_prof</span><span class="p">,</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>  <span class="n">voc_spc</span><span class="o">=</span><span class="n">ind_voc_cbmz</span><span class="p">,</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>  <span class="n">pm_spc</span><span class="o">=</span><span class="n">ind_pm_cbmz</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="p">)</span>
</span></code></pre></div>
<p><code>temporal_profile</code>, <code>voc_spc</code>, and <code>pm_spc</code> are defined the same as in <code>EmissionSource</code>.</p>
<h2 id="creating-a-groupsources-object">Creating a <code>GroupSources</code> object</h2>
<p>Once you defined all the emissions sources in your domain,
you need to group all of them to built the anthropogenic emission file require to run the air quality models.
To that goal we used <code>GroupSources</code>.</p>
<p>Following what we build in this tutorial, we can do the following:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">siem.siem</span><span class="w"> </span><span class="kn">import</span> <span class="n">GroupSources</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">city_sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">city_point_source</span><span class="p">,</span> <span class="n">gasoline</span><span class="p">,</span> <span class="n">diesel</span><span class="p">]</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">city_anthro_emiss</span> <span class="o">=</span> <span class="n">GroupSources</span><span class="p">(</span><span class="n">city_sources</span><span class="p">)</span>
</span></code></pre></div>
<p>That's it!</p>
<p>Now if you want to create emission files for WRF-Chem, you can do:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">wrfinput_d01</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./wrfinput_d01&#39;</span><span class="p">)</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">city_anthro_emiss</span><span class="o">.</span><span class="n">to_wrfchemi</span><span class="p">(</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  <span class="n">wrfinput</span><span class="o">=</span><span class="n">wrfinput_d01</span><span class="p">,</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>  <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2025-10-01&#39;</span><span class="p">,</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>  <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2025-10-01&#39;</span><span class="p">,</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>  <span class="n">week_profile</span><span class="o">=</span><span class="n">week_profile</span><span class="p">,</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>  <span class="n">write_netcdf</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="p">)</span>
</span></code></pre></div>
<p>And for CMAQ:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">wrfinput_d01</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./wrfinput_d01&#39;</span><span class="p">)</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">city_anthro_emiss</span><span class="o">.</span><span class="n">to_wrfchemi</span><span class="p">(</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>  <span class="n">wrfinput</span><span class="o">=</span><span class="n">wrfinput_d01</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>  <span class="n">griddesc_path</span><span class="o">=</span><span class="s1">&#39;./GRIDDESC&#39;</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>  <span class="n">btrim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>  <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2025-10-01&#39;</span><span class="p">,</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>  <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2025-10-01&#39;</span><span class="p">,</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>  <span class="n">week_profile</span><span class="o">=</span> <span class="n">week_profile</span><span class="p">,</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>  <span class="n">write_netcdf</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="p">)</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>